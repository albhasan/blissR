#!/bin/bash
_DEBUG="on"
function DEBUG()
{
 [ "$_DEBUG" == "off" ] &&  $@
}

echo "***********************************************************"
echo "PARALLEL LOAD OF CSV INDIVIDUAL FILES TO 1 DIMMENSION ARRAY"
echo "***********************************************************"
printf "\n"
date -u
DEBUG set -x
start_time=`date +%s`
export LC_ALL="en_US.UTF-8"

#Number of pixels in an image
PIXIMG=23040000

COUNTER=0
for f in /mnt/lun0/csv4scidb/*b01.txt
do
  sudo /opt/scidb/13.11/bin/./loadcsv.py -n 1 -t NNNN  -a 'loadMOD09Q1sur_refl_b01' -s '<i:int64, j:int64, t:int64, value:double> [k=0:*,1000000,0]' -i $f -x -A 'loadMOD09Q1sur_refl_b01_1D'
#-f $((24000000 * COUNTER))
  let COUNTER=COUNTER+1 
  #rm -f $f
done


#COUNTER=0
#for f in /mnt/lun0/csv4scidb/*b02.txt
#do
#  sudo /opt/scidb/13.11/bin/loadcsv.py -n 1 -t NNNN -a 'loadMOD09Q1sur_refl_b02_1D' -i $f -f $((PIXIMG * COUNTER))
#  let COUNTER=COUNTER+1 
#  #rm -f $f 
#done



#COUNTER=0
#for f in /mnt/lun0/csv4scidb/*qc_250m.txt
#do
#  sudo /opt/scidb/13.11/bin/loadcsv.py -n 1 -t NNNN -a 'loadMOD09Q1sur_refl_qc_250m_1D' -i $f  -f $((PIXIMG * COUNTER))
#  let COUNTER=COUNTER+1 
#  #rm -f $f 
#done


end_time=`date +%s`
time_elapsed=$(($end_time-$start_time))
DEBUG set +x
echo "----------------------------"
printf "\n"
date -u
printf "\n"
echo "Finished in $time_elapsed seconds."
echo "PLEASE REDIMMENSION THE ARRAYS IN SCIDB"